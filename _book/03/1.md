# 一、数据链路层的功能

## 1.1 数据链路层基本概念

结点：主机、路由器

链路：网络中两个结点之间的物理通道，链路的传输介质主要有双绞线、光纤和微波。分为有线链路、无线链路。

数据链路：网络中两个结点之间的逻辑通道，把实现控制数据传输协议的硬件和软件加到链路上就构成数据链路。

帧：链路层的协议数据单元，封装网络层数据报。

数据链路层负责通过一条链路从一个结点向另一个物理链路直接相连的相邻结点传送数据报。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-ff885f929e6430e9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

## 1.2 数据链路层的功能

数据链路层在物理层提供服务的基础上向网络层提供服务，其最基本的服务是将源自网络层来的数据可靠地传输到相邻节点的目标机网络层。其主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造成为**逻辑上无差错的数据链路**，使之对网络层表现为一条无差错的链路。

- 为网络层提供服务。无确认无连接服务(适用于实时通信或误码率较低的通信信道，如以太网)，有确认无连接服务(适用于误码率较高的通信信道，如无线通信)，有确认面向连接服务(适用于通信要求较高的场合)。有连接一定有确认，即不存在无确认的面向链接的服务
- 链路管理，即连接的建立、维持、释放（用于面向连接的服务）。
- 组帧。
- 流量控制。
- 差错控制（帧错/位错）。

## 1.3 帧定界、帧同步与透明传输

### 1.3.1 封装成帧

封装成帧就是在一段数据的前后部分添加首部和尾部，这样就构成了一个帧。接收端在收到物理层上交的比特流后，就能根据首部和尾部的标记，从收到的比特流中识别帧的开始和结束。首部和尾部包含许多的控制信息，他们的一个重要作用：帧定界（确定帧的界限）。

帧同步：接收方应当能从接收到的二进制比特流中区分出帧的起始和终止。

组帧的四种方法：

1. 字符计数法：帧首部使用一个计数字段（第一个字节，八位）来标明帧内字符数。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-ac537af1222af03f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

2. 字符（节）填充法：当传送的帧是由文本文件组成时（文本文件的字符都是从键盘上输入的，都是ASCII码）。不管从键盘上输入什么字符都可以放在帧里传过去，即透明传输。当传送的帧是由非ASCII码的文本文件组成时（二进制代码的程序或图像等）。就要采用字符填充方法实现透明传输。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-65d54b96e1952f18.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

3. 零比特填充法：在发送端，扫描整个信息字段，只要连续5个1，就立即填入1个0。在接收端收到一个帧时，先找到标志字段确定边界，再用硬件对比特流进行扫描。发现连续5个1时，就把后面的0删除。其保证了透明传输：在传送的比特流中可以传送任意比特组合，而不会引起对帧边界的判断错误。

4. 违规编码法：可以用“高-高”，“低-低”来定界帧的起始和终止。由于字节计数法中Count字段的脆弱性（其值若有差错将导致灾难性后果）及字符填充实现上的复杂性和不兼容性，目前较普遍使用的帧同步法是比特填充和违规编码法。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-585417dddecf20c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)


### 1.3.2 透明传输

透明传输是指不管所传数据是什么样的比特组合，都应当能够在链路上传送。因此，链路层就“看不见”有什么妨碍数据传输的东西。

当所传数据中的比特组合恰巧与某一个控制信息完全一样时，就必须采取适当的措施，使收方不会将这样的数据误认为是某种控制信息。这样才能保证数据链路层的传输是透明的。