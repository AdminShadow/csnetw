## 二、计算机网络体系与参考模型

## 2.1 计算机网络的分层结构

分层的基本原则：

1. 各层之间相互独立，每层只实现一 种相对独立的功能。 
2. 每层之间界面自然消晰，易千理解，相互交流尽可能少。 
3. 结构上可分割开。每层都采用最合适的技术来实现。
4. 保待下层对上层的独立性，上层单向使用下层提供的服务。
5. 整个分层结构应该能促进标准化工作。

计算机网络的概念：

- 实体：第n层中的活动元素称为n层实体。同一 层的实体叫对等实体。
- 协议：为进行网络中的对等实体数据交换而建立的规则、标准或约定称为网络协议。 【水平】
  - 语法：规定传输数据的格寸
  - 语义：规定所要完成的功能
  - 同步：规定各种操作的顺序

- 接口（访问服务点SAP)：上层使用下层服务的入口。 
- 服务：下层为相邻上层提供的功能调用。 【垂直】

在计算机网络体系结构的各个层次中，每个报文分为两个部分：一是数据部分，即SDU；二是控制信息部分，即PCI，它们共同组成PDU

- SDU服务数据单元：为完成用户所要求的功能而应传送的数据。 
- PCI协议控制信息：控制协议操作的信息。
- PDU协议数据单元：对等层次之间传送的数据单位。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-b0fae946c0a87bba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

## 2.2 ISO/OSI参考模型和TCP/IP模型

### 2.2.1 ISO/OSI参考模型

国际标准化组织(ISO）提出的网络体系结构模型，称为开放系统互连参考模型（OSI RM),通常简称为OSI参考模型。OSI参考模型有7层，自下而上依次为物理层、数据链路层、网络层、传输层、会话层、表示层、应用层。低三层统称为通信子网，它是为了联网而附加的通信设备，完成数据的传输功能;高三层统称为资源子网，它相当于计算机系统，完成数据的处理等功能。传输层承上启下。OSI参考模型的层次结构如图所示。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-70210d98eb04ea1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- 应用层：应用层是OSI参考模型的最高层，是用户与网络的界面。**应用层为特定类型的网络应用提供访问OSI参考模型环境的手段。**因为用户的实际应用多种多样，这就要求应用层采用不同的应用协议来解决不同类型的应用要求，因此应用层是最复杂的一层，使用的协议也最多。典型的协议有用于文件传送的FTP、用于电子邮件的SMTP、用于万维网的HTTP等。
- 表示层：表示层主要处理在两个通信系统中交换信息的表示方式。不同机器采用的编码和表示方法不同，使用的数据结构也不同。为了使不同表示方法的数据和信息之间能互相交换，**表示层采用抽象的标准方法定义数据结构，并采用标准的编码形式。数据压缩、加密和解密也是表示层可提供的数据表示变换功能。**
- 会话层：会话层允许不同主机上的各个进程之间进行会话。会话层利用传输层提供的端到端的服务，向表示层提供它的增值服务。这种服务主要为表示层实体或用户进程建立连接并在连接上有序地传输数据，这就是会话，也称建立同步(SYN).**会话层负责管理主机间的会话进程，包括建立、管理及终止进程间的会话。**会话层可以使用校验点使通信会话在通信失效时从校验点继续恢复通信，实现数据同步。
- 传输层也称运输层，传输单位是报文段(TCP）或用户数据报（UDP)，传输层负责主机中两个进程之间的通信，**功能是为端到端连接提供可靠的传输服务，为端到端连接提供流量控制、差错控制、服务质量、数据传输管理等服务。**使用传输层的服务，高层用户可以直接进行端到端的数据传输，从而忽略通信子网的存在。通过传输层的屏蔽，高层用户看不到子网的交替和变化。由于一台主机可同时运行多个进程，因此传输层具有复用和分用的功能。复用是指多个应用层进程可同时使用下面传输层的服务，分用是指传输层把收到的信息分别交付给上面应用层中相应的进程。
- 网络层：网络层的主要任务是把分组从源端传到目的端，为分组交换网上的不同主机提供通信服务。网络层传输单位是数据报。**它的功能有路由选择(最佳路径)、流量控制、差错控制和拥塞控制**。若所有结点都来不及接受分组，而要丢弃大量分组的话，网络就处于拥塞状态。因此要采取一定措施，缓解这种拥塞。
- 数据链路层：数据链路层的主要任务是把网络层传下来的数据报组装成帧。数据链路层/链路层的传输单位是帧。**它的功能有成帧（定义帧的开始和结束)、差错控制(帧错+位错)、流量控制和访问（接入）控制控制对信道的访问**
- 物理层：物理层的主要任务是在物理媒体上实现比特流的透明传输。物理层传输单位是比特。透明传输:指不管所传数据是什么样的比特组合,都应当能够在链路上传送。**它的功能有定义接口特性、定义传输模式(单工、半双工、双工)、定义传输速率、比特同步和比特编码**

### 2.2.2 TCP/IP参考模型

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-a238ebdfda11a80c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

ARPA在研究ARPAnet时提出了TCP/IP模型，模型从低到高依次为网络接口层（对应OSI参考模型中的物理层和数据链路层)、网际层、传输层和应用层（对应OSI参考模型中的会话层、表示层和应用层)。TCP/P由于得到广泛应用而成为事实上的国际标准。

TCP/IP模型与OSI参考模型有许多相似之处。

- 二者都采取分层的体系结构，将庞大且复杂的问题划分为若干较容易处理的、范围较小的问题,而且分层的功能也大体相似。
- 二者都是基于独立的协议栈的概念。
- 二者都可以解决异构网络的互联，实现世界上不同厂家生产的计算机之间的通信。

两个模型除具有这些基本的相似之处外，也有很多差别。

- OSI参考模型的最大贡献就是精确地定义了三个主要概念:**服务、协议和接口**，这与现代的面向对象程序设计思想非常吻合。而TCP/P模型在这三个概念上却没有明确区分，不符合软件工程的思想。
- **OSI参考模型产生在协议发明之前，没有偏向于任何特定的协议，通用性良好。**但设计者在协议方面没有太多经验，不知道把哪些功能放到哪一层更好。TCP/P模型正好相反，首先出现的是协议，模型实际上是对已有协议的描述，因此不会出现协议不能匹配模型的情况，但该模型不适合于任何其他非TCP/IP的协议栈。
- TCP/IP模型在设计之初就考虑到了多种异构网的互联问题，并将**网际协议(IP)作为一个单独的重要层次**。OSI参考模型最初只考虑到用一种标准的公用数据网将各种不同的系统互联。OSI 参考模型认识到P的重要性后，只好在网络层中划分出一个子层来完成类似于TCP/IP模型中的P的功能。
- OSI参考模型在网络层支持无连接和面向连接的通信，但在传输层仅有面向连接的通信。而TCP/P模型认为可靠性是端到端的问题，因此它在网际层仅有一种无连接的通信模式.但传输层支持无连接和面向连接两种模式。这个不同点常常作为考查点。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-dde909e7dec5679c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

### 2.2.3 5层参考模型

学习计算机网络时，我们往往采取折中的办法，即综合OSI参考模型和TCP/P模型的优点,采用一种如图所示的只有5层协议的体系结构，即我们所熟知的物理层、数据链路层、网络层、传输层和应用层。

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-27e58be19ff687b3.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- 应用层：支持各种网络应用(FTP、SMTP、HTTP)
- 传输层：进程-进程的数据传输(TCP、UDP)
- 网络层：源主机到目的主机的数据分组路由与转发(IP、ICMP、OSPF等)
- 数据链路层：把网络层传下来的数据报组装成帧(Ethernet、PPP)
- 物理层：比特传输