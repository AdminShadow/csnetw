# 三、IPv6

32位IPv4地址空间已分配殆尽，这时，可以采用更大地址空间的新版本的IPv6，从根本上解决地址耗尽问题

>IPv6快速处理/转发数据报且支持QoS
>
>QoS（Quality of Service，服务质量）指一个网络能够利用各种基础技术，为指定的网络通信提供更好的服务能力, 是网络的一种安全机制，是用来解决网络延迟和阻塞等问题的一种技术。

IPv6数据报格式如下图

![图片.png](https://upload-images.jianshu.io/upload_images/26868451-8c85c85a15bff6ba.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)

- 版本：指明了协议版本，总是6。
- 优先级：区分数据报的类别和优先级。
- 流标签：“流”是互联网络上从特定源点到特定终点的一系列数据报。所有属于同一个流的数据报都具有同样的流标签。
- 下一个首部：标识下一个扩展首部或上层协议首部。
- 跳数限制：相当于IPv4的TTL。

IPv6的主要特点如下：

1. IPv6将地址从32位（4B）扩大到**128位（16B）**，更大的地址空间。
2. IPv6将IPv4的校验和字段彻底移除，以减少每跳的处理时间。
3. IPv6将IPv4的可选字段移出首部，变成了**扩展首部**，成为灵活的首部格式，路由器通常不对扩展首部进行检查，大大提高了路由器的处理效率。
4. IPv6支持**即插即用**（即自动配置），不需要DHCP协议。
5. IPv6首部长度必须是**8B的整数倍**，IPv4首部是4B的整数倍。
6. IPv6**只能在主机处分片**，IPv4可以在路由器和主机处分片。
7. ICMPv6：附加报文类型“分组过大”。

8. IPv6支持资源的预分配，支持实时视像等要求，保证一定的带宽和时延的应用。
9. Pv6取消了协议字段，改成下一个首部字段。
10. IPv6取消了总长度字段，改用有效载荷长度字段。
11. IPv6取消了服务类型字段。

IPv6地址表示形式：

- 一般形式：冒号十六进制记法：4BF5:AA12:0216:FEBC:BA5F:039A:BE9A:2170
- 压缩形式：4BF5:0000:0000:0000:BA 5F:039A:000A:2176→4BF5:0:0:0:BA5F:39A:A:2176。

零压缩：一连串连续的0可以被一对冒号取代。双冒号表示法在一个地址中仅可出现一次。

IPv6基本地址类型：

- 单播：一对一通信，可做源地址+目的地址

- 多播：一对多通信，可做目的地址
- 任播：一对多中的一个通信，可做目的地址

IPv6向IPv4过渡的策略：

- 双栈协议：双协议栈技术就是指在一台设备上同时启用IPv4协议栈和IPv6协议栈。这样的话，这台设备既能和IPv4网络通信，又能和IPv6网络通信。如果这台设备是一个路由器，那么这台路由器的不同接口上，分别配置了IPv4地址和IPv6地址，并很可能分别连接了IPv4网络和IPv6网络。如果这台设备是一个计算机，那么它将同时拥有IPv4地址和IPv6地址，并具备同时处理这两个协议地址的功能。
- 隧道技术：通过使用互联网络的基础设施在网络之间传递数据的方式。使用隧道传递的数据（或负载）可以是不同协议的数据帧或包。隧道协议将其它协议的数据帧或包重新封装然后通过隧道发送。

# 